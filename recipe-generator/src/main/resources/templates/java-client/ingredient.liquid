{%- if ingredient.keyed -%}
    {%- assign superclass = 'KeyedIngredient' -%}
{%- else -%}
    {%- assign superclass = 'Ingredient' -%}
{%- endif -%}

import ca.derekcormier.recipe.{{superclass}};

class {{ingredient.name}} extends {{superclass}} {
    {% for required in ingredient.required -%}
    private final {{required.type | javatype}} {{required.name}};
    {% endfor %}
    {%- for initializer in ingredient.initializers %}
    public {{ingredient.name}}(
        {%- for param in initializer.params -%}
            {%- for required in ingredient.required -%}
                {%- if param == required.name -%}
                    {%- assign type = required.type | javatype -%}
                    {%- assign typeWithSpace = type | append: ' ' -%}
                    {%- assign argument = typeWithSpace | append: param -%}
                {%- endif -%}
            {%- endfor -%}
            {{- argument -}}
            {%- unless forloop.last -%}, {% endunless -%}
        {%- endfor -%}
    ) {
        {%- for param in initializer.params %}
        this.{{param}} = {{param}};
        {%- endfor %}
    }{% endfor %}
    {%- for optional in ingredient.optionals %}

    public {{ingredient.name}} with{{optional.name | capitalize}}(
        {%- if optional.type != 'flag' -%}
            {{optional.type | javatype}} {{optional.name}}
        {%- endif -%}
    ) {
        return this;
    }{% endfor %}

    {%- for compoundOptional in ingredient.compoundOptionals %}

    public {{ingredient.name}} with{{compoundOptional.name | capitalize}}(
        {%- for param in compoundOptional.params -%}
            {%- assign type = param.type | javatype -%}
            {%- assign typeWithSpace = type | append: ' ' -%}
            {%- assign argument = typeWithSpace | append: param.name -%}
            {{- argument -}}
            {%- unless forloop.last -%}, {% endunless -%}
        {%- endfor -%}
    ) {
        return this;
    }{% endfor %}
}